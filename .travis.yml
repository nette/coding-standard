language: php

php:
    - 7.1
    - 7.2

matrix:
    include:
        - php: 7.1
          env: COMPOSER_PROJECT=true
        - php: 7.1
          env: RUN_ON_NETTE=true
    allow_failures:
        - php: 7.1
          env: RUN_ON_NETTE=true

install:
    - composer install
    - if [[ $COMPOSER_PROJECT != "" ]]; then composer create-project nette/coding-standard:dev-master#ac8a918 temp/nette-coding-standard; fi
    - if [[ $RUN_ON_NETTE != "" ]]; then composer create-project nette/nette temp/nette; fi

script:
    - composer test
    - if [[ $COMPOSER_PROJECT != "" ]]; then temp/nette-coding-standard/ecs check src examples --config temp/nette-coding-standard/coding-standard-php71.neon; fi
    - if [[ $RUN_ON_NETTE != "" ]]; then vendor/bin/ecs check temp/nette/vendor/nette temp/nette/vendor/latte temp/nette/vendor/tracy --config coding-standard-php56.neon --clear-cache; fi

notifications:
    email: false

sudo: false

cache:
    directories:
        - $HOME/.composer/cache
